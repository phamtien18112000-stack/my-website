{"ast":null,"code":"import { normalizeStructTag, normalizeSuiAddress, parseStructTag } from \"@mysten/sui/utils\";\nfunction isClaimTransaction(tx, options) {\n  let transfers = 0;\n  for (const command of tx.getData().commands) {\n    switch (command.$kind) {\n      case \"TransferObjects\":\n        if (!command.TransferObjects.objects.every(o => o.$kind === \"Result\" || o.$kind === \"NestedResult\")) {\n          return false;\n        }\n        transfers++;\n        break;\n      case \"MoveCall\":\n        if (command.MoveCall.package !== options.packageId) {\n          return false;\n        }\n        if (command.MoveCall.module !== \"zk_bag\") {\n          return false;\n        }\n        const fn = command.MoveCall.function;\n        if (fn !== \"init_claim\" && fn !== \"reclaim\" && fn !== \"claim\" && fn !== \"finalize\") {\n          return false;\n        }\n        break;\n      default:\n        return false;\n    }\n  }\n  return transfers === 1;\n}\nfunction getAssetsFromTransaction({\n  transaction,\n  address,\n  isSent\n}) {\n  const normalizedAddress = normalizeSuiAddress(address);\n  const balances = [];\n  const nfts = [];\n  const coins = [];\n  transaction.balanceChanges?.forEach(change => {\n    const validAmountChange = isSent ? BigInt(change.amount) < 0n : BigInt(change.amount) > 0n;\n    if (validAmountChange && isOwner(change.owner, normalizedAddress)) {\n      balances.push({\n        coinType: normalizeStructTag(change.coinType),\n        amount: BigInt(change.amount)\n      });\n    }\n  });\n  transaction.objectChanges?.forEach(change => {\n    if (!isObjectOwner(change, normalizedAddress, isSent)) {\n      return;\n    }\n    if (\"objectType\" in change) {\n      const type = parseStructTag(change.objectType);\n      if (type.address === normalizeSuiAddress(\"0x2\") && type.module === \"coin\" && type.name === \"Coin\") {\n        if (change.type === \"created\" || change.type === \"transferred\" || change.type === \"mutated\") {\n          coins.push({\n            ...change,\n            type: change.objectType\n          });\n        }\n        return;\n      }\n    }\n    if (isObjectOwner(change, normalizedAddress, isSent) && (change.type === \"created\" || change.type === \"transferred\" || change.type === \"mutated\")) {\n      nfts.push({\n        objectId: change.objectId,\n        type: change.objectType,\n        version: change.version,\n        digest: change.digest\n      });\n    }\n  });\n  return {\n    balances,\n    nfts,\n    coins\n  };\n}\nfunction getObjectOwnerFromObjectChange(objectChange, isSent) {\n  if (isSent) {\n    return \"owner\" in objectChange ? objectChange.owner : null;\n  }\n  return \"recipient\" in objectChange ? objectChange.recipient : null;\n}\nfunction isObjectOwner(objectChange, address, isSent) {\n  const owner = getObjectOwnerFromObjectChange(objectChange, isSent);\n  if (isSent) {\n    return owner && typeof owner === \"object\" && \"AddressOwner\" in owner;\n  }\n  return ownedAfterChange(objectChange, address);\n}\nfunction ownedAfterChange(objectChange, address) {\n  if (objectChange.type === \"transferred\" && isOwner(objectChange.recipient, address)) {\n    return true;\n  }\n  if ((objectChange.type === \"created\" || objectChange.type === \"mutated\") && isOwner(objectChange.owner, address)) {\n    return true;\n  }\n  return false;\n}\nfunction isOwner(owner, address) {\n  return owner && typeof owner === \"object\" && \"AddressOwner\" in owner && normalizeSuiAddress(owner.AddressOwner) === address;\n}\nexport { getAssetsFromTransaction, isClaimTransaction, isOwner, ownedAfterChange };\n//# sourceMappingURL=utils.js.map","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}