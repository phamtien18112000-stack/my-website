{"ast":null,"code":"import { bcs } from \"../../bcs/index.js\";\nimport { TransactionDataBuilder } from \"../../transactions/TransactionData.js\";\nfunction parseTransactionBcs(bytes) {\n  return {\n    ...TransactionDataBuilder.fromBytes(bytes).snapshot(),\n    bcs: bytes\n  };\n}\nfunction parseTransactionEffectsBcs(effects) {\n  const parsed = bcs.TransactionEffects.parse(effects);\n  switch (parsed.$kind) {\n    case \"V1\":\n      return parseTransactionEffectsV1({\n        bytes: effects,\n        effects: parsed.V1\n      });\n    case \"V2\":\n      return parseTransactionEffectsV2({\n        bytes: effects,\n        effects: parsed.V2\n      });\n    default:\n      throw new Error(`Unknown transaction effects version: ${parsed.$kind}`);\n  }\n}\nfunction parseTransactionEffectsV1(_) {\n  throw new Error(\"V1 effects are not supported yet\");\n}\nfunction parseTransactionEffectsV2({\n  bytes,\n  effects\n}) {\n  const changedObjects = effects.changedObjects.map(([id, change]) => {\n    return {\n      id,\n      inputState: change.inputState.$kind === \"Exist\" ? \"Exists\" : \"DoesNotExist\",\n      inputVersion: change.inputState.Exist?.[0][0] ?? null,\n      inputDigest: change.inputState.Exist?.[0][1] ?? null,\n      inputOwner: change.inputState.Exist?.[1] ?? null,\n      outputState: change.outputState.$kind === \"NotExist\" ? \"DoesNotExist\" : change.outputState.$kind,\n      outputVersion: change.outputState.$kind === \"PackageWrite\" ? change.outputState.PackageWrite?.[0] : change.outputState.ObjectWrite ? effects.lamportVersion : null,\n      outputDigest: change.outputState.$kind === \"PackageWrite\" ? change.outputState.PackageWrite?.[1] : change.outputState.ObjectWrite?.[0] ?? null,\n      outputOwner: change.outputState.ObjectWrite ? change.outputState.ObjectWrite[1] : null,\n      idOperation: change.idOperation.$kind\n    };\n  });\n  return {\n    bcs: bytes,\n    digest: effects.transactionDigest,\n    version: 2,\n    status: effects.status.$kind === \"Success\" ? {\n      success: true,\n      error: null\n    } : {\n      success: false,\n      // TODO: add command\n      error: effects.status.Failed.error.$kind\n    },\n    gasUsed: effects.gasUsed,\n    transactionDigest: effects.transactionDigest,\n    gasObject: effects.gasObjectIndex === null ? null : changedObjects[effects.gasObjectIndex] ?? null,\n    eventsDigest: effects.eventsDigest,\n    dependencies: effects.dependencies,\n    lamportVersion: effects.lamportVersion,\n    changedObjects,\n    unchangedConsensusObjects: effects.unchangedSharedObjects.map(([objectId, object]) => {\n      return {\n        kind: object.$kind === \"MutateDeleted\" ? \"MutateConsensusStreamEnded\" : object.$kind === \"ReadDeleted\" ? \"ReadConsensusStreamEnded\" : object.$kind,\n        objectId,\n        version: object.$kind === \"ReadOnlyRoot\" ? object.ReadOnlyRoot[0] : object[object.$kind],\n        digest: object.$kind === \"ReadOnlyRoot\" ? object.ReadOnlyRoot[1] : null\n      };\n    }),\n    auxiliaryDataDigest: effects.auxDataDigest\n  };\n}\nexport { parseTransactionBcs, parseTransactionEffectsBcs };\n//# sourceMappingURL=utils.js.map","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}