{"ast":null,"code":"import { fromBase64, toBase64 } from \"@mysten/bcs\";\nimport { SIGNATURE_SCHEME_TO_FLAG } from \"../cryptography/signature-scheme.js\";\nimport { zkLoginSignature } from \"./bcs.js\";\nfunction getZkLoginSignatureBytes({\n  inputs,\n  maxEpoch,\n  userSignature\n}) {\n  return zkLoginSignature.serialize({\n    inputs,\n    maxEpoch,\n    userSignature: typeof userSignature === \"string\" ? fromBase64(userSignature) : userSignature\n  }, {\n    maxSize: 2048\n  }).toBytes();\n}\nfunction getZkLoginSignature({\n  inputs,\n  maxEpoch,\n  userSignature\n}) {\n  const bytes = getZkLoginSignatureBytes({\n    inputs,\n    maxEpoch,\n    userSignature\n  });\n  const signatureBytes = new Uint8Array(bytes.length + 1);\n  signatureBytes.set([SIGNATURE_SCHEME_TO_FLAG.ZkLogin]);\n  signatureBytes.set(bytes, 1);\n  return toBase64(signatureBytes);\n}\nfunction parseZkLoginSignature(signature) {\n  return zkLoginSignature.parse(typeof signature === \"string\" ? fromBase64(signature) : signature);\n}\nexport { getZkLoginSignature, parseZkLoginSignature };\n//# sourceMappingURL=signature.js.map","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}