{"ast":null,"code":"import { fromBase64, toBase64 } from \"@mysten/bcs\";\nimport { bcs } from \"../bcs/index.js\";\nimport { parseSerializedPasskeySignature } from \"../keypairs/passkey/publickey.js\";\nimport { parseSerializedZkLoginSignature } from \"../zklogin/publickey.js\";\nimport { parseSerializedKeypairSignature } from \"./publickey.js\";\nimport { SIGNATURE_FLAG_TO_SCHEME, SIGNATURE_SCHEME_TO_FLAG } from \"./signature-scheme.js\";\nfunction toSerializedSignature({\n  signature,\n  signatureScheme,\n  publicKey\n}) {\n  if (!publicKey) {\n    throw new Error(\"`publicKey` is required\");\n  }\n  const pubKeyBytes = publicKey.toRawBytes();\n  const serializedSignature = new Uint8Array(1 + signature.length + pubKeyBytes.length);\n  serializedSignature.set([SIGNATURE_SCHEME_TO_FLAG[signatureScheme]]);\n  serializedSignature.set(signature, 1);\n  serializedSignature.set(pubKeyBytes, 1 + signature.length);\n  return toBase64(serializedSignature);\n}\nfunction parseSerializedSignature(serializedSignature) {\n  const bytes = fromBase64(serializedSignature);\n  const signatureScheme = SIGNATURE_FLAG_TO_SCHEME[bytes[0]];\n  switch (signatureScheme) {\n    case \"Passkey\":\n      return parseSerializedPasskeySignature(serializedSignature);\n    case \"MultiSig\":\n      const multisig = bcs.MultiSig.parse(bytes.slice(1));\n      return {\n        serializedSignature,\n        signatureScheme,\n        multisig,\n        bytes,\n        signature: void 0\n      };\n    case \"ZkLogin\":\n      return parseSerializedZkLoginSignature(serializedSignature);\n    case \"ED25519\":\n    case \"Secp256k1\":\n    case \"Secp256r1\":\n      return parseSerializedKeypairSignature(serializedSignature);\n    default:\n      throw new Error(\"Unsupported signature scheme\");\n  }\n}\nexport { parseSerializedSignature, toSerializedSignature };\n//# sourceMappingURL=signature.js.map","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}